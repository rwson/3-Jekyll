<!DOCTYPE html>
<html>
  <!-- Html Head Tag-->
  <head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="rwson">
  <!-- Open Graph Data -->
  <meta property="og:title" content="javascript变量提升"/>
  <meta property="og:description" content="" />
  <meta property="og:site_name" content="小宋"/>
  <meta property="og:type" content="article" />
  <meta property="og:image" content="http://yoursite.comundefined"/>
  
    <link rel="alternate" href="/atom.xml" title="小宋" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  

  <!-- Site Title -->
  <title>小宋</title>

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <!-- Custom CSS -->
  
  <link rel="stylesheet" href="/css/style.light.css">

  <!-- Google Analytics -->
  

</head>

  <body>
    <!-- Page Header -->


<header class="site-header header-background" style="background-image: url(/img/banner.jpeg)">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="page-title with-background-image">
          <p class="title">javascript变量提升</p>
          <p class="subtitle"></p>
        </div>
        <div class="site-menu with-background-image">
          <ul>
            
              <li>
                <a href="/">
                  
                  Home
                  
                </a>
              </li>
            
              <li>
                <a href="/archives">
                  
                  Archives
                  
                </a>
              </li>
            
              <li>
                <a href="https://github.com/rwson">
                  
                  Github
                  
                </a>
              </li>
            
              <li>
                <a href="mailto:862121312@qq.com">
                  
                  Email
                  
                </a>
              </li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>
</header>


<article>
  <div class="container typo">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-info text-muted">
          
            <!-- Author -->
            <span class="author info">By rwson</span>
          
          <!-- Date -->
          <span class="date-time info">On
            <span class="date">2015-07-20</span>
          </span>
          
          <!--  Categories  -->
            <span class="categories info">Under 

<a href="/categories/javascript/">javascript</a> / <a href="/categories/javascript/变量提升/">变量提升</a>
</span>
          
        </div>
        <!-- Tags -->
        
        <!-- Post Main Content -->
        <div class="post-content">
          <p>在日常开发中有时候可能会遇到下面的情况:</p>
<pre><code>var var1 = 1;
function fn() {
    console.log(var1);
    var var1 = 2;
    console.log(var1);
}

fn();   
//  undefined
//  2
</code></pre><p>第一次遇到的人可能会觉得很奇怪(因为外面定义了同名变量,所以第一次应该打印出1),为什么会有这种情况出现呢？我们把代码改成下面的样子就方便理解了:</p>
<pre><code>var var1 = 1;
function fn() {
    var var1;
    //  如果不给变量赋初值,它的值就是undefined
    console.log(var1);
    var1 = 2;
    console.log(var1);
}
</code></pre><p>这就是javascript中的变量提升。<br>MDN上的解释是”变量提升是JavaScript将声明移至作用域scope (全局域或者当前函数作用域) 顶部的行为”。</p>
<p>除了变量,函数也存在变量提升的情况,但是如果用函数直接量法定义一个函数,会报类型异常:</p>
<pre><code>function fn() {
    fnInner();

    var fnInner = function() {
        console.log(&quot;inner fn&quot;);
    }
}

fn();
//  类型异常(undefined is not a function)
</code></pre><p>就像刚才说的,fnInner会被放到函数体的第一行,但是没有赋初值,所以就成了undefined。</p>
<p>但是如果用正常函数声明的方法就可以被正确调用,就像下面的样子:</p>
<pre><code>function fn() {
    fnInner();

    function fnInner() {
        console.log(&quot;inner fn&quot;);
    }
}

fn();
</code></pre><p>甚至有次在angularjs源码中(1.x)看到下面的使用方式:</p>
<pre><code>function x() {
    //  do something
    return {
        attr1: fn1(),
        attr2: fn2()
        //  ...
    };

    function fn1() {
        //  do something
        return {
            //  ...
        };
    }

    function fn2() {
        //  do something
        return {
            //  ...
        };
    }
}
</code></pre><p>当时一看觉得很诧异,主要是一般return以后不能再写代码了,但是又仔细一想,是变量提升的作用。</p>
<p>即使变量提升给我们带来了很大的便利(函数可以在被调用之后声明),但是我们也应该养成变量先定义后使用的习惯,一是提升代码的可读性(不至于在函数体内这里定义一个变量那里定义一个变量的),二是不至于出现一些意想不到的错误或异常。</p>
<p>在ES6中,如果我们用let来定义变量,但是在它定义之前使用,就会报错(使用typeof也会异常),可能ES6也强制我们养成”先定义后调用”的习惯吧。</p>

        </div>
      </div>
    </div>
  </div>
</article>



    <!-- Footer -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <p class="copyright text-muted">
          Build By <a target="_blank" href="https://github.com/rwson">rwson</a>
        <p class="copyright text-muted">
          Powered By <a target="_blank" href="https://hexo.io/">Hexo.</a>
        </p>
      </div>
    </div>
  </div>
</footer>


    <!-- After Footer Scripts -->
<script src="/js/highlight.pack.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function(event) {
    var codeBlocks = Array.prototype.slice.call(document.getElementsByTagName('pre'))
    codeBlocks.forEach(function(block, index) {
      hljs.highlightBlock(block);
    });
  });
</script>

  </body>
</html>

